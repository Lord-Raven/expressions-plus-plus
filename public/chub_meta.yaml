# All of these fields are optional, as is this file itself,
#   in which case these values can be managed in the UI.

# The name of the extension.
project_name: "Expression Packs++"

# A short tagline to show in search.
tagline: "Shows character emotions based on a set of images.++"

# A longer explanation. Supports Markdown format.
creator_notes: "
_Apologies as I transition alpha features into regular usage. There is a good chance I spoil existing content, and I'm very sorry if that occurs to you._  
  
This is a shameless knock-off of the [official Expression Packs stage](https://chub.ai/extensions/BartlebyTheScrivener/expressions-extension-768927333d4d). 
You can add this stage to any chat by searching for it under Stages in Chat Settings, but you may want to read some of this beforehand.  
  
In addition to pulling official expression packs, this stage can generate expression and background art for any character (and even personae) using Chub's generative endpoints. 
  
The system works with any single-character bot or even personae, but _it uses lots of image generation credits_ (unless you have a Mars subscription, which is unlimited), and your mileage may vary quality-wise. 
Images may initially take time to appear as they must be generated; they are lazy loaded, so they don't hold up the chat so much. 
You can regenerate individual images and create different \"outfits\" using the characters' settings in the upper-right corner.  
  
This stage also generates background images based on the scene. These are not lazy loaded because it causes saving issues, and they can easily become out of sync. 
They can add quite a bit of load time to responses when they occur, but they can also be disabled from the stage's configuration menu. 
  
From the configuration menu, you can also alter the basic art style element of the stage's image prompts, to taylor the style to suit your aesthetic.  
  
### Improvements Over the Original 

<li>This stage can be used with any character, without manual effort by the author.<br>
<li>This stage supports multiple characters. You will need to refresh the chat after adding a new character, though.<br>
<li>This stage supports persona images.<br>
<li>This stage supports multiplayer.<br>
<li>This stage allows you to toggle character outfits or visibility from within the stage UI itself.<br>
<li>This stage includes backgrounds.<br>
<li>This stage discards neutral emotion determinations when a secondary emotion is over a certain threshold, which causes characters to appear more expressive.<br>

### Disimprovements Under the Original 

<li>If you don't have a Mars subscription, and the bot's author didn't pre-generate content, this could use an exorbitant amount of credits.<br>

That's it! If you have a Mars subscription and you want some expression images, there's literally no reason to use the original over this one.

### External Dependencies 

This stage leverages [SamLowe/roberta-base-go_emotions](https://huggingface.co/SamLowe/roberta-base-go_emotions) for emotion inference ([my HF space for this](https://huggingface.co/spaces/Ravenok/emotions)) 
and [MoritzLaurer/ModernBERT-large-zeroshot-v2.0](https://huggingface.co/MoritzLaurer/ModernBERT-large-zeroshot-v2.0) for zero-shot classification ([my HF space for that](https://huggingface.co/spaces/Ravenok/statosphere-backend)).

### Image Generation and Sensitive Material 

This stage doesn't directly contain any NSFW material and doesn't do anything to prompt NSFW images, but a lot of the content is dependent upon the nature of 
the characters and narrative that are being depicted. Chub's image generation will outright fail on triggering words or phrases that it deems sensitive; 
the system appears to use a rather naive test for this purpose, and because the stage relies on generated art prompts, 
I have implemented some simple key word substitution to avoid needless failures, but there are
undoubtedly situations that will still fail. The character management UI will indicate this next to each outfit.  

### Updates  

2025.08.16:

- Swapped over to the new storage API for outfit and background content. Official expression packs are also accessible now. A lot of past content has probably been lost, but the new storage allows for content to be 
shared across instances of the stage; for instance, player outfits can be marked global to persist across chats. If you own a character, you can mark outfits global for other users to leverage.

2025.07.10: 

- Started to do some outfit initialization configuration and then rolled it back; Lore confirmed that expression pack support are coming to other stages soon, so I will wait patiently for that.

2025.07.08: 

- Added a blank where you can modify the outfit description or copy/paste outfit details to effectively export and import them into new outfits, characters, or chats. 

2025.07.01: 

- Added image prompt details and warnings to each outfit tabs in the management UI. 

- Minor prompt revisions. 

2025.06.29: 

- UI revisions, mostly to make the stage usable on mobile. 

- Fixed background generation triggering too frequently. 

2025.06.28: 

- User persona support. 

- Outfit management. 

- Visibility toggles for characters. 

- Users and multi-character or narrator bots are invisible by default, to avoid confusing situations. 

- Images are now generated as-needed, which can mean a delay in initial use, but you can still manually pre-load them from character management. 

- Various prompt improvements. 
"

# 'PUBLIC', 'PRIVATE', or 'UNLISTED'.
visibility: 'PUBLIC'

position: 'ADJACENT'

# Self-explanatory.
tags:
 - 'Extension'
 - 'Expressions'
 - 'Expression Packs'
 - 'Emotions'
 - 'Stage'
 - 'Add-on'

config_schema:
  title: Expressions Config
  type: object
  properties:
    generateCharacters:
      title: Generate Character Art
      description: Automatically generate an expression pack for characters (will expend daily credits); this is basically all the stage currently does, so maybe leave this one on.
      type: string
      default: "True"
      enum: ["True", "False"]
    generateBackgrounds:
      title: Generate Background Art
      description: Automatically generate backgrounds during scene changes.
      type: string
      default: "True"
      enum: ["True", "False"]
    artStyle:
      title: Art Style
      description: A brief description of the desired character art style.
      type: string
      default: "Bold, visual novel style illustration, clean lines"
    useBackgroundDepth:
      title: Background Depth
      description: Enable depth effects for backgrounds.
      type: string
      default: "True"
      enum: ["True", "False"]
    alphaMode:
      title: Alpha Mode
      description: Enable experimental stuff. Maybe don't use this if your username isn't Ravenok.
      type: string
      default: "False"
      enum: ["True", "False"]

github_path: 'https://github.com/Lord-Raven/expressions-plus-plus'

extension_id: 'expressions-plus-plus-a8db5f0bd422'
